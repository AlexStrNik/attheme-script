{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "attheme-script",
	"patterns": [
		{
			"include": "#regex"
		},
		{
			"include": "#functions"
		},
		{
			"include": "#for"
		},
		{
			"include": "#numeric-values"
		},
		{
			"include": "#color-values"
		},
		{
			"match": "([a-zA-Z0-9-])+\\s*[:=]",
			"name": "entity.name"
		},
		{
			"include": "#arrays"
		},
		{
			"include": "#if-elif"
		},
		{
			"include": "#else"
		}
	],
	"repository": {
		"regex": {
			"name": "string.quoted.double.attheme.regex",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.attheme",
					"match": "\\\\."
				}
			]
		},
		"variables":{
			"match": "\\$([a-zA-Z0-9-]+)\\b",
			"name": "support.type.object.module.js"
		},
		"operators":{
			"match":"[=!<>]|(\\s+in\\s+)",
			"name":"support.function.misc.attheme"
		},
		"else":{
			"begin":"(else)",
			"end":"{",
			"beginCaptures":{
				"1":{
					"name":"keyword.attheme"
				}
			}
		},
		"if-elif":{
			"begin":"\\b(if|elif)",
			"beginCaptures": {
				"1": {
					"name":"keyword.attheme"
				}
			},
			"end":"{",
			"patterns": [
				{
					"include": "#variables"
				},
				{
					"include": "#operators"
				},
				{
					"include": "#functions"
				},
				{
					"include": "#arrays"
				},
				{
					"include": "#regex"
				},
				{
					"include": "#numeric-values"
				},
				{
					"include": "#color-values"
				}
			]
		},
		"color-values": {
			"patterns": [
				{
					"comment": "http://www.w3.org/TR/CSS21/syndata.html#value-def-color",
					"match": "\\b(aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow)\\b",
					"name": "support.constant.color.w3c-standard-color-name.attheme"
				},
				{
					"comment": "These colours are mostly recognised but will not validate. ref: http://www.w3schools.com/attheme/attheme_colornames.asp",
					"match": "\\b(aliceblue|antiquewhite|aquamarine|azure|beige|bisque|blanchedalmond|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkgrey|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|gainsboro|ghostwhite|gold|goldenrod|greenyellow|grey|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|limegreen|linen|magenta|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|oldlace|olivedrab|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|thistle|tomato|turquoise|violet|wheat|whitesmoke|yellowgreen)\\b",
					"name": "support.constant.color.w3c-standard-color-name.attheme"
				},
				{
					"include": "#variables"
				},
				{
					"begin": "(hsla?|rgba?|rgb?|hsl?)\\s*(\\()",
					"beginCaptures": {
						"1": {
							"name": "support.function.misc.attheme"
						},
						"2": {
							"name": "support.function.misc.attheme"
						}
					},
					"end": "(\\))",
					"endCaptures": {
						"1": {
							"name": "support.function.misc.attheme"
						}
					},
					"patterns": [
						{
							"match": "(?x)\\b\n\t\t\t\t\t\t\t    (0*((1?[0-9]{1,2})|(2([0-4][0-9]|5[0-5])))\\s*,\\s*){2}\n\t\t\t\t\t\t\t    (0*((1?[0-9]{1,2})|(2([0-4][0-9]|5[0-5])))\\b)\n\t\t\t\t\t\t\t    (\\s*,\\s*((0?\\.[0-9]+)|[0-1]))?\n\t\t\t\t\t\t\t",
							"name": "constant.other.color.rgb-value.attheme"
						},
						{
							"match": "\\b([0-9]{1,2}|100)\\s*%,\\s*([0-9]{1,2}|100)\\s*%,\\s*([0-9]{1,2}|100)\\s*%",
							"name": "constant.other.color.rgb-percentage.attheme"
						}
					]
				},
				{
					"begin": "\\b",
					"end": "\\b",
					"include": "#numeric-values"
				}
			]
		},
		"numeric-values": {
			"patterns": [
				{
					"match": "#([0-9a-fA-F]{3,4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})\\b",
					"name": "constant.other.color.rgb-value.hex"
				},
				{
					"match": "(?x)(?:(?:[0-9]+(?:\\.[0-9]+)?)|(?:\\.[0-9]+))",
					"name": "constant.numeric.attheme",
					"captures": {
						"2":{
							"name": "support.function.misc.attheme"
						}
					}
				}
			]
		},
		"arrays": {
			"name": "color.arrays.attheme",
			"begin": "(\\[)",
			"end": "(\\])",
			"patterns": [
				{
					"include": "#functions"
				},
				{
					"include": "#color-values"
				},
				{
					"include": "#numeric-values"
				},
				{
					"match": "([a-zA-Z0-9-])+\\s*[:=]",
					"name": "entity.name"
				}
			]
		},

		"for": {
			"name": "structures.for.attheme",
			"begin": "(for)\\s+(\\$[a-zA-Z0-9]+)\\s*,\\s*(\\$[a-zA-Z0-9]+)\\s+(in)",
			"beginCaptures": {
				"1" : {
					"name":"keyword.attheme"
				},
				"2": {
					"name":"meta.property.object.js"
				},
				"3":{
					"name":"meta.property.object.js"
				},
				"4": {
					"name":"keyword.attheme"
				}
			},
			"end": "\\{",
			"patterns": [
				{
					"include": "#arrays"
				},
				{
					"include": "#functions"
				},
				{
					"include": "#regex"
				}			
			]
		},

		"functions": {
			"name" : "support.function.misc.attheme",
			"begin": "([a-zA-Z0-9]+)\\s*(\\()",
			"beginCaptures": {
				"2": {
					"name": "support.function.misc.attheme"
				}
			},
			"end": "(\\))",
			"endCaptures": {
				"1": {
					"name": "support.function.misc.attheme"
				}
			},
			"patterns": [
				{
					"include": "#color-values"
				},
				{
					"include": "#numeric-values"
				},
				{
					"include": "#functions"
				}
			]
		}
	},
	"scopeName": "source.attheme"
}